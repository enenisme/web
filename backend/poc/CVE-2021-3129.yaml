id: VUL-2021-31448
name: CVE-2021-3129
tags:
    - laravel
transport: http
set:
    Str: randomLowercase(15)
    Name: randomLowercase(15)
rules:
    r0:
        request:
            body: |-
                {
                        "solution": "Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution",
                        "parameters": {
                          "variableName": "{{Name}}",
                          "viewFile": "{{Str}}"
                        }
                }
            cache: true
            follow_redirects: true
            headers:
                Content-Type: application/json
            method: POST
            path: /_ignition/execute-solution
        expression: |
            response.status == 500 && response.body.bcontains(bytes("file_get_contents(" + string(Str) + ")")) && response.body.bcontains(bytes("failed to open stream"))
        output: null
expression: r0()
detail:
    fingerprint:
        softhard: ""
        product: ""
        company: ""
        category: ""
        parent_category: ""
    vulnerability:
        proof: {}


