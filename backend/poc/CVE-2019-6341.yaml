id: VUL-2019-03108
name: CVE-2019-6341
tags:
    - Drupal
transport: http
set: null
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /user/register
        expression: response.status == 200 && 
                    response.headers["Cache-Control"].contains("must-revalidate, no-cache, private") &&
                    response.headers["X-Drupal-Cache"].contains("HIT") &&
                    response.headers["X-Generator"].contains("Drupal") &&
                    response.body.bcontains(b'Search')
        output: null
    r1:
        request:
            cache: true
            method: GET
            path: /CHANGELOG.txt
        expression: response.status == 200 && 
                    r'Drupal 7\.[0-6][0-5]'.bmatches(response.body) && !(r'Drupal 7\.[7-9][0-9]'.bmatches(response.body)) &&
                    response.body.bcontains(b'- Initial release') &&
                    response.body.bcontains(b'- Revised documentation') &&
                    response.body.bcontains(b'- Rewrote the comment/discussion code:') &&
                    response.body.bcontains(b'- Added sections and section manager:') &&
                    response.body.bcontains(b'Node system:')

        output: null 
expression: r0() && r1()
detail:
    fingerprint:
        softhard: ""
        product: ""
        company: ""
        category: ""
        parent_category: ""
    vulnerability:
        proof: {}




